var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);$(document).ready(function(){if(typeof dataLayer!=="undefined"){for(var b=document.getElementsByTagName("iframe"),a=b.length;a--;){if(/youtube.com\/embed/.test(b[a].src)){if(b[a].src.indexOf("enablejsapi=")===-1){b[a].src+=(b[a].src.indexOf("?")===-1?"?":"&")+"enablejsapi=1"}}}}});var gtmYTListeners=[];function onYouTubeIframeAPIReady(){for(var b=document.getElementsByTagName("iframe"),a=b.length;a--;){if(/youtube.com\/embed/.test(b[a].src)){gtmYTListeners.push(new YT.Player(b[a],{events:{onStateChange:onPlayerStateChange,onError:onPlayerError}}));YT.gtmLastAction="p"}}}function onPlayerStateChange(c){c.data==YT.PlayerState.PLAYING&&setTimeout(onPlayerPercent,1000,c.target);var b=c.target.getVideoData(),a=b.video_id+":"+b.title;if(c.data==YT.PlayerState.PLAYING&&YT.gtmLastAction=="p"){dataLayer.push({event:"youtube",action:"play",label:a});YT.gtmLastAction=""}if(c.data==YT.PlayerState.PAUSED){dataLayer.push({event:"youtube",action:"pause",label:a});YT.gtmLastAction="p"}}function onPlayerError(a){dataLayer.push({event:"error",action:"GTM",label:"youtube:"+a})}function onPlayerPercent(d){if(d.getPlayerState()==YT.PlayerState.PLAYING){var c=d.getDuration()-d.getCurrentTime()<=1.5?1:(Math.floor(d.getCurrentTime()/d.getDuration()*4)/4).toFixed(2);if(!d.lastP||c>d.lastP){var b=d.getVideoData(),a=b.video_id+":"+b.title;d.lastP=c;dataLayer.push({event:"youtube",action:c*100+"%",label:a})}d.lastP!=1&&setTimeout(onPlayerPercent,1000,d)}}var existingOnBeforeUnloadHandler=window.onbeforeunload;window.onbeforeunload=function(a){var a=a||window.event;if(a){a.returnValue="na"}return"na"};window.onbeforeunload=function(a){trackYTUnload();if(existingOnBeforeUnloadHandler){existingOnBeforeUnloadHandler(a)}};function trackYTUnload(){for(var c=0;c<gtmYTListeners.length;c++){if(gtmYTlisteners[c].getPlayerState()===1){var b=gtmYTlisteners[c]["getVideoData"](),a=b.video_id+":"+b.title;dataLayer.push({event:"youtube",action:"exit",label:a})}}};